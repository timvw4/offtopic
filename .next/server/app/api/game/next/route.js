"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/game/next/route";
exports.ids = ["app/api/game/next/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgame%2Fnext%2Froute&page=%2Fapi%2Fgame%2Fnext%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgame%2Fnext%2Froute.ts&appDir=%2FUsers%2Ftimvw%2FDesktop%2Foff-topic%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftimvw%2FDesktop%2Foff-topic&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgame%2Fnext%2Froute&page=%2Fapi%2Fgame%2Fnext%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgame%2Fnext%2Froute.ts&appDir=%2FUsers%2Ftimvw%2FDesktop%2Foff-topic%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftimvw%2FDesktop%2Foff-topic&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_timvw_Desktop_off_topic_app_api_game_next_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/game/next/route.ts */ \"(rsc)/./app/api/game/next/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/game/next/route\",\n        pathname: \"/api/game/next\",\n        filename: \"route\",\n        bundlePath: \"app/api/game/next/route\"\n    },\n    resolvedPagePath: \"/Users/timvw/Desktop/off-topic/app/api/game/next/route.ts\",\n    nextConfigOutput,\n    userland: _Users_timvw_Desktop_off_topic_app_api_game_next_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/game/next/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZnYW1lJTJGbmV4dCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGZ2FtZSUyRm5leHQlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZnYW1lJTJGbmV4dCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnRpbXZ3JTJGRGVza3RvcCUyRm9mZi10b3BpYyUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZ0aW12dyUyRkRlc2t0b3AlMkZvZmYtdG9waWMmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ1M7QUFDdEY7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vZmYtdG9waWMvP2E1MzkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL3RpbXZ3L0Rlc2t0b3Avb2ZmLXRvcGljL2FwcC9hcGkvZ2FtZS9uZXh0L3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9nYW1lL25leHQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9nYW1lL25leHRcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2dhbWUvbmV4dC9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy90aW12dy9EZXNrdG9wL29mZi10b3BpYy9hcHAvYXBpL2dhbWUvbmV4dC9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvZ2FtZS9uZXh0L3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgame%2Fnext%2Froute&page=%2Fapi%2Fgame%2Fnext%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgame%2Fnext%2Froute.ts&appDir=%2FUsers%2Ftimvw%2FDesktop%2Foff-topic%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftimvw%2FDesktop%2Foff-topic&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/game/next/route.ts":
/*!************************************!*\
  !*** ./app/api/game/next/route.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabaseClient */ \"(rsc)/./lib/supabaseClient.ts\");\n/* harmony import */ var _lib_stateMachine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/stateMachine */ \"(rsc)/./lib/stateMachine.ts\");\n\n\n\nfunction normalizeSettings(playerCount, settings) {\n    if (playerCount <= 4) {\n        return {\n            hors_theme_count: 1,\n            has_cameleon: settings.has_cameleon,\n            has_dictator: settings.has_dictator,\n            drawing_timer_seconds: settings.drawing_timer_seconds\n        };\n    }\n    if (playerCount <= 6) {\n        const ht = [\n            1,\n            2\n        ].includes(settings.hors_theme_count) ? settings.hors_theme_count : 1;\n        return {\n            hors_theme_count: ht,\n            has_cameleon: settings.has_cameleon,\n            has_dictator: settings.has_dictator,\n            drawing_timer_seconds: settings.drawing_timer_seconds\n        };\n    }\n    const ht = [\n        2,\n        3\n    ].includes(settings.hors_theme_count) ? settings.hors_theme_count : 2;\n    return {\n        hors_theme_count: ht,\n        has_cameleon: settings.has_cameleon,\n        has_dictator: settings.has_dictator,\n        drawing_timer_seconds: settings.drawing_timer_seconds\n    };\n}\nfunction shuffle(arr) {\n    return arr.map((x)=>({\n            x,\n            r: Math.random()\n        })).sort((a, b)=>a.r - b.r).map((o)=>o.x);\n}\nasync function POST(request) {\n    if (!_lib_supabaseClient__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        error: \"Service key manquant\"\n    }, {\n        status: 500\n    });\n    const { roomCode } = await request.json();\n    if (!roomCode) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        error: \"roomCode manquant\"\n    }, {\n        status: 400\n    });\n    const { data: room } = await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"rooms\").select(\"current_phase, hors_theme_count, has_cameleon, has_dictator, drawing_timer_seconds\").eq(\"code\", roomCode).single();\n    (0,_lib_stateMachine__WEBPACK_IMPORTED_MODULE_2__.assertTransition)(room?.current_phase || \"RESULTS\", \"WORD\");\n    // Seuls les joueurs non éliminés participent au nouveau tour\n    const { data: alivePlayers } = await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"players\").select(\"id\").eq(\"room_code\", roomCode).eq(\"is_eliminated\", false);\n    if (!alivePlayers || alivePlayers.length < 2) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Minimum 2 joueurs restants requis\"\n        }, {\n            status: 400\n        });\n    }\n    const effective = normalizeSettings(alivePlayers.length, {\n        hors_theme_count: room?.hors_theme_count ?? 1,\n        has_cameleon: room?.has_cameleon ?? false,\n        has_dictator: room?.has_dictator ?? false,\n        drawing_timer_seconds: room?.drawing_timer_seconds ?? 60\n    });\n    const timerSeconds = [\n        30,\n        45,\n        60,\n        90,\n        120\n    ].includes(effective.drawing_timer_seconds ?? 60) ? effective.drawing_timer_seconds : 60;\n    // Purge des données de manche précédente pour ne pas mélanger les écrans,\n    // mais on conserve les flags d'élimination et les rôles/words (pas de redistribution).\n    await Promise.all([\n        _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"drawings\").delete().eq(\"room_code\", roomCode),\n        _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"votes\").delete().eq(\"room_code\", roomCode),\n        _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"chameleon_accusations\").delete().eq(\"room_code\", roomCode)\n    ]);\n    // Reset seulement l'état prêt des joueurs encore en jeu (on conserve l'usage d'accusation pour la partie).\n    await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"players\").update({\n        is_ready: false\n    }).eq(\"room_code\", roomCode).eq(\"is_eliminated\", false);\n    // Récupère le dernier mot pour le conserver sur le prochain tour\n    const { data: lastRound } = await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"rounds\").select(\"word_civil, word_hors_theme\").eq(\"room_code\", roomCode).order(\"created_at\", {\n        ascending: false\n    }).limit(1).maybeSingle();\n    // Démarrage dessin synchronisé (compte à rebours partagé)\n    const drawStartsAt = new Date(Date.now() + 3000).toISOString();\n    await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"rounds\").insert({\n        room_code: roomCode,\n        phase: \"DRAW\",\n        word_civil: lastRound?.word_civil || \"chat\",\n        word_hors_theme: lastRound?.word_hors_theme || \"chien\",\n        timer_seconds: timerSeconds,\n        tie_player_ids: null,\n        draw_starts_at: drawStartsAt,\n        dictator_survived: false\n    });\n    await _lib_supabaseClient__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"rooms\").update({\n        current_phase: \"DRAW\",\n        hors_theme_count: effective.hors_theme_count,\n        has_cameleon: effective.has_cameleon,\n        has_dictator: effective.has_dictator,\n        drawing_timer_seconds: timerSeconds\n    }).eq(\"code\", roomCode);\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        ok: true,\n        timerSeconds,\n        drawStartsAt\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2dhbWUvbmV4dC9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTJDO0FBQ1U7QUFDQztBQVN0RCxTQUFTRyxrQkFBa0JDLFdBQW1CLEVBQUVDLFFBQWtCO0lBQ2hFLElBQUlELGVBQWUsR0FBRztRQUNwQixPQUFPO1lBQ0xFLGtCQUFrQjtZQUNsQkMsY0FBY0YsU0FBU0UsWUFBWTtZQUNuQ0MsY0FBY0gsU0FBU0csWUFBWTtZQUNuQ0MsdUJBQXVCSixTQUFTSSxxQkFBcUI7UUFDdkQ7SUFDRjtJQUNBLElBQUlMLGVBQWUsR0FBRztRQUNwQixNQUFNTSxLQUFLO1lBQUM7WUFBRztTQUFFLENBQUNDLFFBQVEsQ0FBQ04sU0FBU0MsZ0JBQWdCLElBQUlELFNBQVNDLGdCQUFnQixHQUFHO1FBQ3BGLE9BQU87WUFDTEEsa0JBQWtCSTtZQUNsQkgsY0FBY0YsU0FBU0UsWUFBWTtZQUNuQ0MsY0FBY0gsU0FBU0csWUFBWTtZQUNuQ0MsdUJBQXVCSixTQUFTSSxxQkFBcUI7UUFDdkQ7SUFDRjtJQUNBLE1BQU1DLEtBQUs7UUFBQztRQUFHO0tBQUUsQ0FBQ0MsUUFBUSxDQUFDTixTQUFTQyxnQkFBZ0IsSUFBSUQsU0FBU0MsZ0JBQWdCLEdBQUc7SUFDcEYsT0FBTztRQUNMQSxrQkFBa0JJO1FBQ2xCSCxjQUFjRixTQUFTRSxZQUFZO1FBQ25DQyxjQUFjSCxTQUFTRyxZQUFZO1FBQ25DQyx1QkFBdUJKLFNBQVNJLHFCQUFxQjtJQUN2RDtBQUNGO0FBRUEsU0FBU0csUUFBV0MsR0FBUTtJQUMxQixPQUFPQSxJQUNKQyxHQUFHLENBQUMsQ0FBQ0MsSUFBTztZQUFFQTtZQUFHQyxHQUFHQyxLQUFLQyxNQUFNO1FBQUcsSUFDbENDLElBQUksQ0FBQyxDQUFDQyxHQUFHQyxJQUFNRCxFQUFFSixDQUFDLEdBQUdLLEVBQUVMLENBQUMsRUFDeEJGLEdBQUcsQ0FBQyxDQUFDUSxJQUFNQSxFQUFFUCxDQUFDO0FBQ25CO0FBRU8sZUFBZVEsS0FBS0MsT0FBZ0I7SUFDekMsSUFBSSxDQUFDdkIsOERBQWFBLEVBQUUsT0FBT0QscURBQVlBLENBQUN5QixJQUFJLENBQUM7UUFBRUMsT0FBTztJQUF1QixHQUFHO1FBQUVDLFFBQVE7SUFBSTtJQUM5RixNQUFNLEVBQUVDLFFBQVEsRUFBRSxHQUFHLE1BQU1KLFFBQVFDLElBQUk7SUFDdkMsSUFBSSxDQUFDRyxVQUFVLE9BQU81QixxREFBWUEsQ0FBQ3lCLElBQUksQ0FBQztRQUFFQyxPQUFPO0lBQW9CLEdBQUc7UUFBRUMsUUFBUTtJQUFJO0lBRXRGLE1BQU0sRUFBRUUsTUFBTUMsSUFBSSxFQUFFLEdBQUcsTUFBTTdCLDhEQUFhQSxDQUN2QzhCLElBQUksQ0FBQyxTQUNMQyxNQUFNLENBQUMsc0ZBQ1BDLEVBQUUsQ0FBQyxRQUFRTCxVQUNYTSxNQUFNO0lBQ1RoQyxtRUFBZ0JBLENBQUM0QixNQUFNSyxpQkFBaUIsV0FBVztJQUVuRCw2REFBNkQ7SUFDN0QsTUFBTSxFQUFFTixNQUFNTyxZQUFZLEVBQUUsR0FBRyxNQUFNbkMsOERBQWFBLENBQy9DOEIsSUFBSSxDQUFDLFdBQ0xDLE1BQU0sQ0FBQyxNQUNQQyxFQUFFLENBQUMsYUFBYUwsVUFDaEJLLEVBQUUsQ0FBQyxpQkFBaUI7SUFFdkIsSUFBSSxDQUFDRyxnQkFBZ0JBLGFBQWFDLE1BQU0sR0FBRyxHQUFHO1FBQzVDLE9BQU9yQyxxREFBWUEsQ0FBQ3lCLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQW9DLEdBQUc7WUFBRUMsUUFBUTtRQUFJO0lBQ3pGO0lBRUEsTUFBTVcsWUFBWW5DLGtCQUFrQmlDLGFBQWFDLE1BQU0sRUFBRTtRQUN2RC9CLGtCQUFrQndCLE1BQU14QixvQkFBb0I7UUFDNUNDLGNBQWN1QixNQUFNdkIsZ0JBQWdCO1FBQ3BDQyxjQUFjc0IsTUFBTXRCLGdCQUFnQjtRQUNwQ0MsdUJBQXVCcUIsTUFBTXJCLHlCQUF5QjtJQUN4RDtJQUVBLE1BQU04QixlQUFlO1FBQUM7UUFBSTtRQUFJO1FBQUk7UUFBSTtLQUFJLENBQUM1QixRQUFRLENBQUMyQixVQUFVN0IscUJBQXFCLElBQUksTUFDbkY2QixVQUFVN0IscUJBQXFCLEdBQy9CO0lBRUosMEVBQTBFO0lBQzFFLHVGQUF1RjtJQUN2RixNQUFNK0IsUUFBUUMsR0FBRyxDQUFDO1FBQ2hCeEMsOERBQWFBLENBQUM4QixJQUFJLENBQUMsWUFBWVcsTUFBTSxHQUFHVCxFQUFFLENBQUMsYUFBYUw7UUFDeEQzQiw4REFBYUEsQ0FBQzhCLElBQUksQ0FBQyxTQUFTVyxNQUFNLEdBQUdULEVBQUUsQ0FBQyxhQUFhTDtRQUNyRDNCLDhEQUFhQSxDQUFDOEIsSUFBSSxDQUFDLHlCQUF5QlcsTUFBTSxHQUFHVCxFQUFFLENBQUMsYUFBYUw7S0FDdEU7SUFFRCwyR0FBMkc7SUFDM0csTUFBTTNCLDhEQUFhQSxDQUNoQjhCLElBQUksQ0FBQyxXQUNMWSxNQUFNLENBQUM7UUFBRUMsVUFBVTtJQUFNLEdBQ3pCWCxFQUFFLENBQUMsYUFBYUwsVUFDaEJLLEVBQUUsQ0FBQyxpQkFBaUI7SUFFdkIsaUVBQWlFO0lBQ2pFLE1BQU0sRUFBRUosTUFBTWdCLFNBQVMsRUFBRSxHQUFHLE1BQU01Qyw4REFBYUEsQ0FDNUM4QixJQUFJLENBQUMsVUFDTEMsTUFBTSxDQUFDLCtCQUNQQyxFQUFFLENBQUMsYUFBYUwsVUFDaEJrQixLQUFLLENBQUMsY0FBYztRQUFFQyxXQUFXO0lBQU0sR0FDdkNDLEtBQUssQ0FBQyxHQUNOQyxXQUFXO0lBRWQsMERBQTBEO0lBQzFELE1BQU1DLGVBQWUsSUFBSUMsS0FBS0EsS0FBS0MsR0FBRyxLQUFLLE1BQU1DLFdBQVc7SUFFNUQsTUFBTXBELDhEQUFhQSxDQUFDOEIsSUFBSSxDQUFDLFVBQVV1QixNQUFNLENBQUM7UUFDeENDLFdBQVczQjtRQUNYNEIsT0FBTztRQUNQQyxZQUFZWixXQUFXWSxjQUFjO1FBQ3JDQyxpQkFBaUJiLFdBQVdhLG1CQUFtQjtRQUMvQ0MsZUFBZXBCO1FBQ2ZxQixnQkFBZ0I7UUFDaEJDLGdCQUFnQlg7UUFDaEJZLG1CQUFtQjtJQUNyQjtJQUVBLE1BQU03RCw4REFBYUEsQ0FDaEI4QixJQUFJLENBQUMsU0FDTFksTUFBTSxDQUFDO1FBQ05SLGVBQWU7UUFDZjdCLGtCQUFrQmdDLFVBQVVoQyxnQkFBZ0I7UUFDNUNDLGNBQWMrQixVQUFVL0IsWUFBWTtRQUNwQ0MsY0FBYzhCLFVBQVU5QixZQUFZO1FBQ3BDQyx1QkFBdUI4QjtJQUN6QixHQUNDTixFQUFFLENBQUMsUUFBUUw7SUFFZCxPQUFPNUIscURBQVlBLENBQUN5QixJQUFJLENBQUM7UUFBRXNDLElBQUk7UUFBTXhCO1FBQWNXO0lBQWE7QUFDbEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vZmYtdG9waWMvLi9hcHAvYXBpL2dhbWUvbmV4dC9yb3V0ZS50cz80YmZjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuaW1wb3J0IHsgc3VwYWJhc2VBZG1pbiB9IGZyb20gXCJAL2xpYi9zdXBhYmFzZUNsaWVudFwiO1xuaW1wb3J0IHsgYXNzZXJ0VHJhbnNpdGlvbiB9IGZyb20gXCJAL2xpYi9zdGF0ZU1hY2hpbmVcIjtcblxudHlwZSBTZXR0aW5ncyA9IHtcbiAgaG9yc190aGVtZV9jb3VudDogbnVtYmVyO1xuICBoYXNfY2FtZWxlb246IGJvb2xlYW47XG4gIGhhc19kaWN0YXRvcjogYm9vbGVhbjtcbiAgZHJhd2luZ190aW1lcl9zZWNvbmRzPzogbnVtYmVyO1xufTtcblxuZnVuY3Rpb24gbm9ybWFsaXplU2V0dGluZ3MocGxheWVyQ291bnQ6IG51bWJlciwgc2V0dGluZ3M6IFNldHRpbmdzKTogU2V0dGluZ3Mge1xuICBpZiAocGxheWVyQ291bnQgPD0gNCkge1xuICAgIHJldHVybiB7XG4gICAgICBob3JzX3RoZW1lX2NvdW50OiAxLFxuICAgICAgaGFzX2NhbWVsZW9uOiBzZXR0aW5ncy5oYXNfY2FtZWxlb24sXG4gICAgICBoYXNfZGljdGF0b3I6IHNldHRpbmdzLmhhc19kaWN0YXRvcixcbiAgICAgIGRyYXdpbmdfdGltZXJfc2Vjb25kczogc2V0dGluZ3MuZHJhd2luZ190aW1lcl9zZWNvbmRzLFxuICAgIH07XG4gIH1cbiAgaWYgKHBsYXllckNvdW50IDw9IDYpIHtcbiAgICBjb25zdCBodCA9IFsxLCAyXS5pbmNsdWRlcyhzZXR0aW5ncy5ob3JzX3RoZW1lX2NvdW50KSA/IHNldHRpbmdzLmhvcnNfdGhlbWVfY291bnQgOiAxO1xuICAgIHJldHVybiB7XG4gICAgICBob3JzX3RoZW1lX2NvdW50OiBodCxcbiAgICAgIGhhc19jYW1lbGVvbjogc2V0dGluZ3MuaGFzX2NhbWVsZW9uLFxuICAgICAgaGFzX2RpY3RhdG9yOiBzZXR0aW5ncy5oYXNfZGljdGF0b3IsXG4gICAgICBkcmF3aW5nX3RpbWVyX3NlY29uZHM6IHNldHRpbmdzLmRyYXdpbmdfdGltZXJfc2Vjb25kcyxcbiAgICB9O1xuICB9XG4gIGNvbnN0IGh0ID0gWzIsIDNdLmluY2x1ZGVzKHNldHRpbmdzLmhvcnNfdGhlbWVfY291bnQpID8gc2V0dGluZ3MuaG9yc190aGVtZV9jb3VudCA6IDI7XG4gIHJldHVybiB7XG4gICAgaG9yc190aGVtZV9jb3VudDogaHQsXG4gICAgaGFzX2NhbWVsZW9uOiBzZXR0aW5ncy5oYXNfY2FtZWxlb24sXG4gICAgaGFzX2RpY3RhdG9yOiBzZXR0aW5ncy5oYXNfZGljdGF0b3IsXG4gICAgZHJhd2luZ190aW1lcl9zZWNvbmRzOiBzZXR0aW5ncy5kcmF3aW5nX3RpbWVyX3NlY29uZHMsXG4gIH07XG59XG5cbmZ1bmN0aW9uIHNodWZmbGU8VD4oYXJyOiBUW10pOiBUW10ge1xuICByZXR1cm4gYXJyXG4gICAgLm1hcCgoeCkgPT4gKHsgeCwgcjogTWF0aC5yYW5kb20oKSB9KSlcbiAgICAuc29ydCgoYSwgYikgPT4gYS5yIC0gYi5yKVxuICAgIC5tYXAoKG8pID0+IG8ueCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IFJlcXVlc3QpIHtcbiAgaWYgKCFzdXBhYmFzZUFkbWluKSByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJTZXJ2aWNlIGtleSBtYW5xdWFudFwiIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gIGNvbnN0IHsgcm9vbUNvZGUgfSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICBpZiAoIXJvb21Db2RlKSByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJyb29tQ29kZSBtYW5xdWFudFwiIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG5cbiAgY29uc3QgeyBkYXRhOiByb29tIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgLmZyb20oXCJyb29tc1wiKVxuICAgIC5zZWxlY3QoXCJjdXJyZW50X3BoYXNlLCBob3JzX3RoZW1lX2NvdW50LCBoYXNfY2FtZWxlb24sIGhhc19kaWN0YXRvciwgZHJhd2luZ190aW1lcl9zZWNvbmRzXCIpXG4gICAgLmVxKFwiY29kZVwiLCByb29tQ29kZSlcbiAgICAuc2luZ2xlKCk7XG4gIGFzc2VydFRyYW5zaXRpb24ocm9vbT8uY3VycmVudF9waGFzZSB8fCBcIlJFU1VMVFNcIiwgXCJXT1JEXCIpO1xuXG4gIC8vIFNldWxzIGxlcyBqb3VldXJzIG5vbiDDqWxpbWluw6lzIHBhcnRpY2lwZW50IGF1IG5vdXZlYXUgdG91clxuICBjb25zdCB7IGRhdGE6IGFsaXZlUGxheWVycyB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgIC5mcm9tKFwicGxheWVyc1wiKVxuICAgIC5zZWxlY3QoXCJpZFwiKVxuICAgIC5lcShcInJvb21fY29kZVwiLCByb29tQ29kZSlcbiAgICAuZXEoXCJpc19lbGltaW5hdGVkXCIsIGZhbHNlKTtcblxuICBpZiAoIWFsaXZlUGxheWVycyB8fCBhbGl2ZVBsYXllcnMubGVuZ3RoIDwgMikge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIk1pbmltdW0gMiBqb3VldXJzIHJlc3RhbnRzIHJlcXVpc1wiIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gIH1cblxuICBjb25zdCBlZmZlY3RpdmUgPSBub3JtYWxpemVTZXR0aW5ncyhhbGl2ZVBsYXllcnMubGVuZ3RoLCB7XG4gICAgaG9yc190aGVtZV9jb3VudDogcm9vbT8uaG9yc190aGVtZV9jb3VudCA/PyAxLFxuICAgIGhhc19jYW1lbGVvbjogcm9vbT8uaGFzX2NhbWVsZW9uID8/IGZhbHNlLFxuICAgIGhhc19kaWN0YXRvcjogcm9vbT8uaGFzX2RpY3RhdG9yID8/IGZhbHNlLFxuICAgIGRyYXdpbmdfdGltZXJfc2Vjb25kczogcm9vbT8uZHJhd2luZ190aW1lcl9zZWNvbmRzID8/IDYwLFxuICB9KTtcblxuICBjb25zdCB0aW1lclNlY29uZHMgPSBbMzAsIDQ1LCA2MCwgOTAsIDEyMF0uaW5jbHVkZXMoZWZmZWN0aXZlLmRyYXdpbmdfdGltZXJfc2Vjb25kcyA/PyA2MClcbiAgICA/IGVmZmVjdGl2ZS5kcmF3aW5nX3RpbWVyX3NlY29uZHNcbiAgICA6IDYwO1xuXG4gIC8vIFB1cmdlIGRlcyBkb25uw6llcyBkZSBtYW5jaGUgcHLDqWPDqWRlbnRlIHBvdXIgbmUgcGFzIG3DqWxhbmdlciBsZXMgw6ljcmFucyxcbiAgLy8gbWFpcyBvbiBjb25zZXJ2ZSBsZXMgZmxhZ3MgZCfDqWxpbWluYXRpb24gZXQgbGVzIHLDtGxlcy93b3JkcyAocGFzIGRlIHJlZGlzdHJpYnV0aW9uKS5cbiAgYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgIHN1cGFiYXNlQWRtaW4uZnJvbShcImRyYXdpbmdzXCIpLmRlbGV0ZSgpLmVxKFwicm9vbV9jb2RlXCIsIHJvb21Db2RlKSxcbiAgICBzdXBhYmFzZUFkbWluLmZyb20oXCJ2b3Rlc1wiKS5kZWxldGUoKS5lcShcInJvb21fY29kZVwiLCByb29tQ29kZSksXG4gICAgc3VwYWJhc2VBZG1pbi5mcm9tKFwiY2hhbWVsZW9uX2FjY3VzYXRpb25zXCIpLmRlbGV0ZSgpLmVxKFwicm9vbV9jb2RlXCIsIHJvb21Db2RlKSxcbiAgXSk7XG5cbiAgLy8gUmVzZXQgc2V1bGVtZW50IGwnw6l0YXQgcHLDqnQgZGVzIGpvdWV1cnMgZW5jb3JlIGVuIGpldSAob24gY29uc2VydmUgbCd1c2FnZSBkJ2FjY3VzYXRpb24gcG91ciBsYSBwYXJ0aWUpLlxuICBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgLmZyb20oXCJwbGF5ZXJzXCIpXG4gICAgLnVwZGF0ZSh7IGlzX3JlYWR5OiBmYWxzZSB9KVxuICAgIC5lcShcInJvb21fY29kZVwiLCByb29tQ29kZSlcbiAgICAuZXEoXCJpc19lbGltaW5hdGVkXCIsIGZhbHNlKTtcblxuICAvLyBSw6ljdXDDqHJlIGxlIGRlcm5pZXIgbW90IHBvdXIgbGUgY29uc2VydmVyIHN1ciBsZSBwcm9jaGFpbiB0b3VyXG4gIGNvbnN0IHsgZGF0YTogbGFzdFJvdW5kIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgLmZyb20oXCJyb3VuZHNcIilcbiAgICAuc2VsZWN0KFwid29yZF9jaXZpbCwgd29yZF9ob3JzX3RoZW1lXCIpXG4gICAgLmVxKFwicm9vbV9jb2RlXCIsIHJvb21Db2RlKVxuICAgIC5vcmRlcihcImNyZWF0ZWRfYXRcIiwgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgLmxpbWl0KDEpXG4gICAgLm1heWJlU2luZ2xlKCk7XG5cbiAgLy8gRMOpbWFycmFnZSBkZXNzaW4gc3luY2hyb25pc8OpIChjb21wdGUgw6AgcmVib3VycyBwYXJ0YWfDqSlcbiAgY29uc3QgZHJhd1N0YXJ0c0F0ID0gbmV3IERhdGUoRGF0ZS5ub3coKSArIDMwMDApLnRvSVNPU3RyaW5nKCk7XG5cbiAgYXdhaXQgc3VwYWJhc2VBZG1pbi5mcm9tKFwicm91bmRzXCIpLmluc2VydCh7XG4gICAgcm9vbV9jb2RlOiByb29tQ29kZSxcbiAgICBwaGFzZTogXCJEUkFXXCIsXG4gICAgd29yZF9jaXZpbDogbGFzdFJvdW5kPy53b3JkX2NpdmlsIHx8IFwiY2hhdFwiLFxuICAgIHdvcmRfaG9yc190aGVtZTogbGFzdFJvdW5kPy53b3JkX2hvcnNfdGhlbWUgfHwgXCJjaGllblwiLFxuICAgIHRpbWVyX3NlY29uZHM6IHRpbWVyU2Vjb25kcyxcbiAgICB0aWVfcGxheWVyX2lkczogbnVsbCxcbiAgICBkcmF3X3N0YXJ0c19hdDogZHJhd1N0YXJ0c0F0LFxuICAgIGRpY3RhdG9yX3N1cnZpdmVkOiBmYWxzZSxcbiAgfSk7XG5cbiAgYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgIC5mcm9tKFwicm9vbXNcIilcbiAgICAudXBkYXRlKHtcbiAgICAgIGN1cnJlbnRfcGhhc2U6IFwiRFJBV1wiLFxuICAgICAgaG9yc190aGVtZV9jb3VudDogZWZmZWN0aXZlLmhvcnNfdGhlbWVfY291bnQsXG4gICAgICBoYXNfY2FtZWxlb246IGVmZmVjdGl2ZS5oYXNfY2FtZWxlb24sXG4gICAgICBoYXNfZGljdGF0b3I6IGVmZmVjdGl2ZS5oYXNfZGljdGF0b3IsXG4gICAgICBkcmF3aW5nX3RpbWVyX3NlY29uZHM6IHRpbWVyU2Vjb25kcyxcbiAgICB9KVxuICAgIC5lcShcImNvZGVcIiwgcm9vbUNvZGUpO1xuXG4gIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG9rOiB0cnVlLCB0aW1lclNlY29uZHMsIGRyYXdTdGFydHNBdCB9KTtcbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJzdXBhYmFzZUFkbWluIiwiYXNzZXJ0VHJhbnNpdGlvbiIsIm5vcm1hbGl6ZVNldHRpbmdzIiwicGxheWVyQ291bnQiLCJzZXR0aW5ncyIsImhvcnNfdGhlbWVfY291bnQiLCJoYXNfY2FtZWxlb24iLCJoYXNfZGljdGF0b3IiLCJkcmF3aW5nX3RpbWVyX3NlY29uZHMiLCJodCIsImluY2x1ZGVzIiwic2h1ZmZsZSIsImFyciIsIm1hcCIsIngiLCJyIiwiTWF0aCIsInJhbmRvbSIsInNvcnQiLCJhIiwiYiIsIm8iLCJQT1NUIiwicmVxdWVzdCIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsInJvb21Db2RlIiwiZGF0YSIsInJvb20iLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJzaW5nbGUiLCJjdXJyZW50X3BoYXNlIiwiYWxpdmVQbGF5ZXJzIiwibGVuZ3RoIiwiZWZmZWN0aXZlIiwidGltZXJTZWNvbmRzIiwiUHJvbWlzZSIsImFsbCIsImRlbGV0ZSIsInVwZGF0ZSIsImlzX3JlYWR5IiwibGFzdFJvdW5kIiwib3JkZXIiLCJhc2NlbmRpbmciLCJsaW1pdCIsIm1heWJlU2luZ2xlIiwiZHJhd1N0YXJ0c0F0IiwiRGF0ZSIsIm5vdyIsInRvSVNPU3RyaW5nIiwiaW5zZXJ0Iiwicm9vbV9jb2RlIiwicGhhc2UiLCJ3b3JkX2NpdmlsIiwid29yZF9ob3JzX3RoZW1lIiwidGltZXJfc2Vjb25kcyIsInRpZV9wbGF5ZXJfaWRzIiwiZHJhd19zdGFydHNfYXQiLCJkaWN0YXRvcl9zdXJ2aXZlZCIsIm9rIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/game/next/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/stateMachine.ts":
/*!*****************************!*\
  !*** ./lib/stateMachine.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   assertTransition: () => (/* binding */ assertTransition),\n/* harmony export */   canTransition: () => (/* binding */ canTransition)\n/* harmony export */ });\n// Table de transitions alignée sur le flux réellement implémenté.\nconst transitions = [\n    {\n        from: \"LOBBY\",\n        to: \"WORD\"\n    },\n    // Le passage à DRAW est déclenché par l'horodatage commun `draw_starts_at`.\n    {\n        from: \"WORD\",\n        to: \"DRAW\"\n    },\n    // Dans le flux actuel, la phase DB peut rester à WORD jusqu'au passage au vote.\n    {\n        from: \"WORD\",\n        to: \"VOTE\"\n    },\n    {\n        from: \"DRAW\",\n        to: \"REVEAL\"\n    },\n    {\n        from: \"REVEAL\",\n        to: \"VOTE\"\n    },\n    {\n        from: \"VOTE\",\n        to: \"RESULTS\"\n    },\n    // Revote en cas d'égalité\n    {\n        from: \"RESULTS\",\n        to: \"VOTE\"\n    },\n    // Nouveau tour depuis les résultats\n    {\n        from: \"RESULTS\",\n        to: \"WORD\"\n    },\n    // Retour lobby (reset manuel)\n    {\n        from: \"RESULTS\",\n        to: \"LOBBY\"\n    }\n];\nfunction canTransition(current, next) {\n    return transitions.some((t)=>t.from === current && t.to === next && (!t.guard || t.guard()));\n}\nfunction assertTransition(current, next) {\n    if (!canTransition(current, next)) {\n        throw new Error(`Transition refusée: ${current} → ${next}`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3RhdGVNYWNoaW5lLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBUUEsa0VBQWtFO0FBQ2xFLE1BQU1BLGNBQTRCO0lBQ2hDO1FBQUVDLE1BQU07UUFBU0MsSUFBSTtJQUFPO0lBQzVCLDRFQUE0RTtJQUM1RTtRQUFFRCxNQUFNO1FBQVFDLElBQUk7SUFBTztJQUMzQixnRkFBZ0Y7SUFDaEY7UUFBRUQsTUFBTTtRQUFRQyxJQUFJO0lBQU87SUFDM0I7UUFBRUQsTUFBTTtRQUFRQyxJQUFJO0lBQVM7SUFDN0I7UUFBRUQsTUFBTTtRQUFVQyxJQUFJO0lBQU87SUFDN0I7UUFBRUQsTUFBTTtRQUFRQyxJQUFJO0lBQVU7SUFDOUIsMEJBQTBCO0lBQzFCO1FBQUVELE1BQU07UUFBV0MsSUFBSTtJQUFPO0lBQzlCLG9DQUFvQztJQUNwQztRQUFFRCxNQUFNO1FBQVdDLElBQUk7SUFBTztJQUM5Qiw4QkFBOEI7SUFDOUI7UUFBRUQsTUFBTTtRQUFXQyxJQUFJO0lBQVE7Q0FDaEM7QUFFTSxTQUFTQyxjQUFjQyxPQUFrQixFQUFFQyxJQUFlO0lBQy9ELE9BQU9MLFlBQVlNLElBQUksQ0FBQyxDQUFDQyxJQUFNQSxFQUFFTixJQUFJLEtBQUtHLFdBQVdHLEVBQUVMLEVBQUUsS0FBS0csUUFBUyxFQUFDRSxFQUFFQyxLQUFLLElBQUlELEVBQUVDLEtBQUssRUFBQztBQUM3RjtBQUVPLFNBQVNDLGlCQUFpQkwsT0FBa0IsRUFBRUMsSUFBZTtJQUNsRSxJQUFJLENBQUNGLGNBQWNDLFNBQVNDLE9BQU87UUFDakMsTUFBTSxJQUFJSyxNQUFNLENBQUMsb0JBQW9CLEVBQUVOLFFBQVEsR0FBRyxFQUFFQyxLQUFLLENBQUM7SUFDNUQ7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL29mZi10b3BpYy8uL2xpYi9zdGF0ZU1hY2hpbmUudHM/NmM5ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBHYW1lUGhhc2UgfSBmcm9tIFwiLi90eXBlc1wiO1xuXG50eXBlIFRyYW5zaXRpb24gPSB7XG4gIGZyb206IEdhbWVQaGFzZTtcbiAgdG86IEdhbWVQaGFzZTtcbiAgZ3VhcmQ/OiAoKSA9PiBib29sZWFuO1xufTtcblxuLy8gVGFibGUgZGUgdHJhbnNpdGlvbnMgYWxpZ27DqWUgc3VyIGxlIGZsdXggcsOpZWxsZW1lbnQgaW1wbMOpbWVudMOpLlxuY29uc3QgdHJhbnNpdGlvbnM6IFRyYW5zaXRpb25bXSA9IFtcbiAgeyBmcm9tOiBcIkxPQkJZXCIsIHRvOiBcIldPUkRcIiB9LFxuICAvLyBMZSBwYXNzYWdlIMOgIERSQVcgZXN0IGTDqWNsZW5jaMOpIHBhciBsJ2hvcm9kYXRhZ2UgY29tbXVuIGBkcmF3X3N0YXJ0c19hdGAuXG4gIHsgZnJvbTogXCJXT1JEXCIsIHRvOiBcIkRSQVdcIiB9LFxuICAvLyBEYW5zIGxlIGZsdXggYWN0dWVsLCBsYSBwaGFzZSBEQiBwZXV0IHJlc3RlciDDoCBXT1JEIGp1c3F1J2F1IHBhc3NhZ2UgYXUgdm90ZS5cbiAgeyBmcm9tOiBcIldPUkRcIiwgdG86IFwiVk9URVwiIH0sXG4gIHsgZnJvbTogXCJEUkFXXCIsIHRvOiBcIlJFVkVBTFwiIH0sXG4gIHsgZnJvbTogXCJSRVZFQUxcIiwgdG86IFwiVk9URVwiIH0sXG4gIHsgZnJvbTogXCJWT1RFXCIsIHRvOiBcIlJFU1VMVFNcIiB9LFxuICAvLyBSZXZvdGUgZW4gY2FzIGQnw6lnYWxpdMOpXG4gIHsgZnJvbTogXCJSRVNVTFRTXCIsIHRvOiBcIlZPVEVcIiB9LFxuICAvLyBOb3V2ZWF1IHRvdXIgZGVwdWlzIGxlcyByw6lzdWx0YXRzXG4gIHsgZnJvbTogXCJSRVNVTFRTXCIsIHRvOiBcIldPUkRcIiB9LFxuICAvLyBSZXRvdXIgbG9iYnkgKHJlc2V0IG1hbnVlbClcbiAgeyBmcm9tOiBcIlJFU1VMVFNcIiwgdG86IFwiTE9CQllcIiB9LFxuXTtcblxuZXhwb3J0IGZ1bmN0aW9uIGNhblRyYW5zaXRpb24oY3VycmVudDogR2FtZVBoYXNlLCBuZXh0OiBHYW1lUGhhc2UpOiBib29sZWFuIHtcbiAgcmV0dXJuIHRyYW5zaXRpb25zLnNvbWUoKHQpID0+IHQuZnJvbSA9PT0gY3VycmVudCAmJiB0LnRvID09PSBuZXh0ICYmICghdC5ndWFyZCB8fCB0Lmd1YXJkKCkpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydFRyYW5zaXRpb24oY3VycmVudDogR2FtZVBoYXNlLCBuZXh0OiBHYW1lUGhhc2UpIHtcbiAgaWYgKCFjYW5UcmFuc2l0aW9uKGN1cnJlbnQsIG5leHQpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBUcmFuc2l0aW9uIHJlZnVzw6llOiAke2N1cnJlbnR9IOKGkiAke25leHR9YCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJ0cmFuc2l0aW9ucyIsImZyb20iLCJ0byIsImNhblRyYW5zaXRpb24iLCJjdXJyZW50IiwibmV4dCIsInNvbWUiLCJ0IiwiZ3VhcmQiLCJhc3NlcnRUcmFuc2l0aW9uIiwiRXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/stateMachine.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabaseClient.ts":
/*!*******************************!*\
  !*** ./lib/supabaseClient.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin),\n/* harmony export */   supabaseClient: () => (/* binding */ supabaseClient)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/index.mjs\");\n\nconst supabaseUrl = \"https://ljucerfrutijxjtspoef.supabase.co\";\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxqdWNlcmZydXRpanhqdHNwb2VmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk1NjUyNTAsImV4cCI6MjA4NTE0MTI1MH0.9AaEFAJvzRUWPf5KG53NHnIQzsQwTkMe_n5wd46gZ6Q\";\nconst supabaseClient = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey);\nconst supabaseAdmin = process.env.SUPABASE_SERVICE_ROLE_KEY ? (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, process.env.SUPABASE_SERVICE_ROLE_KEY) : null;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2VDbGllbnQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXFEO0FBRXJELE1BQU1DLGNBQWNDLDBDQUFvQztBQUN4RCxNQUFNRyxrQkFBa0JILGtOQUF5QztBQUUxRCxNQUFNSyxpQkFBaUJQLG1FQUFZQSxDQUFDQyxhQUFhSSxpQkFBaUI7QUFFbEUsTUFBTUcsZ0JBQWdCTixRQUFRQyxHQUFHLENBQUNNLHlCQUF5QixHQUM5RFQsbUVBQVlBLENBQUNDLGFBQWFDLFFBQVFDLEdBQUcsQ0FBQ00seUJBQXlCLElBQy9ELEtBQUsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vZmYtdG9waWMvLi9saWIvc3VwYWJhc2VDbGllbnQudHM/M2E3ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tIFwiQHN1cGFiYXNlL3N1cGFiYXNlLWpzXCI7XG5cbmNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMITtcbmNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZITtcblxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlQ2xpZW50ID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUFub25LZXkpO1xuXG5leHBvcnQgY29uc3Qgc3VwYWJhc2VBZG1pbiA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVlcbiAgPyBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkpXG4gIDogbnVsbDtcbiJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsInN1cGFiYXNlQ2xpZW50Iiwic3VwYWJhc2VBZG1pbiIsIlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabaseClient.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/next","vendor-chunks/tslib","vendor-chunks/iceberg-js"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgame%2Fnext%2Froute&page=%2Fapi%2Fgame%2Fnext%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgame%2Fnext%2Froute.ts&appDir=%2FUsers%2Ftimvw%2FDesktop%2Foff-topic%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftimvw%2FDesktop%2Foff-topic&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();